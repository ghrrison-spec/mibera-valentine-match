# Loa Framework Configuration
# This file is yours to customize - framework updates will never modify it

# =============================================================================
# Persistence Mode
# =============================================================================
# - standard: Commit grimoire and beads to repo (default)
# - stealth: Add state files to .gitignore, local-only operation
persistence_mode: standard

# =============================================================================
# Integrity Enforcement (Projen-Level)
# =============================================================================
# - strict: Block agent execution on System Zone drift (recommended, mandatory for CI)
# - warn: Warn but allow execution (development only)
# - disabled: No integrity checks (not recommended)
integrity_enforcement: strict

# =============================================================================
# Drift Resolution Policy
# =============================================================================
# - code: Update documentation to match implementation (existing codebases)
# - docs: Create beads to fix code to match documentation (greenfield)
# - ask: Always prompt for human decision
drift_resolution: code

# =============================================================================
# Agent Configuration
# =============================================================================
disabled_agents: []
# disabled_agents:
#   - auditing-security
#   - translating-for-executives

# =============================================================================
# Custom Paths
# =============================================================================
paths:
  grimoire: grimoires/loa
  beads: .beads

# =============================================================================
# Structured Agentic Memory (Anthropic-Level)
# =============================================================================
memory:
  # Persistent working memory file
  notes_file: grimoires/loa/NOTES.md
  # Trajectory logs for ADK-style evaluation
  trajectory_dir: grimoires/loa/a2a/trajectory
  # Auto-compact trajectory logs older than N days
  trajectory_retention_days: 30
  # Restore context from NOTES.md on session start
  auto_restore: true

  # -------------------------------------------------------------------------
  # NOTES.md Learnings Sync (v1.8.0)
  # -------------------------------------------------------------------------
  # Auto-sync learnings from NOTES.md to vector database on session start
  auto_sync: false

  # -------------------------------------------------------------------------
  # PreToolUse Hook - Mid-Stream Memory Injection (v1.8.0)
  # -------------------------------------------------------------------------
  pretooluse_hook:
    # Master toggle for mid-stream injection
    enabled: true
    # Characters to extract from thinking block
    thinking_chars: 1500
    # Minimum similarity score for memory recall
    similarity_threshold: 0.35
    # Maximum memories to inject per tool use
    max_memories: 3
    # Hard timeout for entire hook execution (milliseconds)
    timeout_ms: 500
    # Tools that trigger the hook
    tools:
      - Read
      - Glob
      - Grep
      - WebFetch
      - WebSearch

  # -------------------------------------------------------------------------
  # Vector Database Configuration
  # -------------------------------------------------------------------------
  vector_db:
    # Database file location (relative to project root)
    path: .loa/memory.db
    # Embedding model (sentence-transformers)
    model: all-MiniLM-L6-v2
    # Embedding dimension (must match model)
    dimension: 384

  # -------------------------------------------------------------------------
  # QMD Integration - Document Search (v1.8.0)
  # -------------------------------------------------------------------------
  qmd:
    # Master toggle for QMD integration
    enabled: false
    # QMD binary path (or just 'qmd' for PATH)
    binary: qmd
    # Index storage location
    index_dir: .loa/qmd
    # Collections to index
    collections:
      - path: grimoires/loa
        name: loa-state
        include: ["*.md"]
        exclude: ["archive/**", "a2a/trajectory/**"]
      - path: grimoires/loa/reality
        name: loa-reality
        include: ["*.md"]

# =============================================================================
# Evaluation-Driven Development (ADK-Level)
# =============================================================================
edd:
  enabled: true
  # Require N test scenarios before marking task complete
  min_test_scenarios: 3
  # Audit reasoning trajectory for hallucination
  trajectory_audit: true
  # Require explicit grounding for all claims
  require_citations: true

# =============================================================================
# Context Hygiene
# =============================================================================
compaction:
  enabled: true
  # Trigger compaction after this many closed tasks in a sprint
  threshold: 5

# =============================================================================
# Integrations
# =============================================================================
integrations:
  - github
  - linear

# =============================================================================
# Drift Detection (Sprint 4 - FR-9.1, GitHub Issue #10)
# =============================================================================
drift_detection:
  # Directories to watch for changes
  watch_paths:
    - ".claude/"
    - "grimoires/loa/"
    # Add custom directories as needed:
    # - ".meta/"
    # - "docs/architecture/"

  # Patterns to exclude from drift detection
  exclude_patterns:
    - "**/node_modules/**"
    - "**/*.log"
    - "**/.DS_Store"
    - "**/dist/**"
    - "**/build/**"
    - "**/__pycache__/**"

# =============================================================================
# Context Filtering (Sprint 4 - FR-9.2, GitHub Issue #10)
# =============================================================================
context_filtering:
  # Master toggle: set to false to disable all filtering
  enable_filtering: true

  # Archive zone - automatically excluded from all searches
  archive_zone: "grimoires/loa/archive/"

  # Signal threshold: exclude documents below this level
  # Options: low, medium, high
  # - high: Only include high-signal documents
  # - medium: Include medium and high (default)
  # - low: Include all (effectively no filtering)
  signal_threshold: "medium"

  # Patterns for low-signal documents to exclude
  default_excludes:
    - "**/brainstorm-*.md"
    - "**/session-notes-*.md"
    - "**/meeting-*.md"
    - "**/draft-*.md"
    - "**/scratch-*.md"
    - "**/temp-*.md"

  # Auto-archive drafts older than N days (0 = disabled)
  draft_ttl_days: 30

  # Frontmatter signal marker support
  respect_frontmatter_signals: true

# =============================================================================
# Lossless Ledger Protocol (v0.9.0)
# =============================================================================
# Paradigm: "Clear, Don't Compact" - Synthesize to ledgers before clearing

# Grounding Enforcement - requires citations for claims
grounding:
  # Minimum ratio of grounded claims (citations + code_references) to total claims
  threshold: 0.95
  # Enforcement level: strict (block /clear), warn (warn only), disabled
  enforcement: warn
  # Negative grounding for Ghost Features
  negative:
    enabled: true
    # Similarity threshold for semantic search (below = "not found")
    similarity_threshold: 0.4
    # Require 2 diverse queries for verification
    require_diverse_queries: true

# Attention Budget - advisory thresholds for context management
attention_budget:
  # Green zone: under this, no action needed
  green_threshold: 2000
  # Yellow zone: trigger delta-synthesis
  yellow_threshold: 5000
  # Orange zone: recommend /clear
  orange_threshold: 7500
  # Red zone: strong recommendation for /clear
  red_threshold: 10000
  # Advisory only (never blocks, just warns)
  advisory_only: true

# Session Continuity - recovery after /clear or new session
session_continuity:
  # Enable tiered recovery (Level 1/2/3)
  tiered_recovery: true
  # Level 1 recovery token budget (~100 tokens)
  level1_tokens: 100
  # Level 2 recovery token budget (~500 tokens)
  level2_tokens: 500
  # Auto-load Session Continuity section on session start
  auto_restore: true

# Synthesis Checkpoint - pre-clear validation
synthesis_checkpoint:
  # Enable blocking validation before /clear
  enabled: true
  # Grounding threshold for checkpoint (defaults to grounding.threshold)
  grounding_threshold: 0.95
  # EDD minimum test scenarios per decision
  edd:
    enabled: true
    min_test_scenarios: 3
    warn_only: true

# JIT Retrieval - lightweight identifiers instead of eager loading
jit_retrieval:
  # Prefer ck for semantic search when available
  prefer_ck: true
  # Enable fallback to grep/sed when ck unavailable
  fallback_enabled: true
  # Maximum lines to retrieve at once
  max_line_range: 100

# =============================================================================
# Registry Integration (v0.9.2+)
# =============================================================================
# Loa Constructs for third-party skill management
# Production API: https://loa-constructs-api.fly.dev
registry:
  # Master toggle for registry features
  enabled: true
  # Default registry API URL (can be overridden with LOA_REGISTRY_URL env var)
  # Note: Production API endpoint for Loa Constructs
  default_url: "https://loa-constructs-api.fly.dev/v1"
  # Cache public keys for N hours (reduces API calls)
  public_key_cache_hours: 24
  # Load registry skills during /setup
  load_on_startup: true
  # Validate license signatures (disable only for testing)
  # NOTE: Disabled for sk_test_ keys - HS256 tokens not supported by RS256 validator
  validate_licenses: false
  # Offline grace period in hours (tier-based, this is default for free/pro)
  offline_grace_hours: 24
  # Auto-refresh threshold: warn if license expires within N hours
  auto_refresh_threshold_hours: 24
  # Check for skill updates during /setup
  check_updates_on_setup: true
  # Reserved skill names (cannot be installed from registry)
  reserved_skill_names:
    - discovering-requirements
    - designing-architecture
    - planning-sprints
    - implementing-tasks
    - reviewing-code
    - auditing-security
    - deploying-infrastructure
    - riding-codebase
    - mounting-framework
    - translating-for-executives

# =============================================================================
# Structured Outputs (Claude Platform Integration)
# =============================================================================
# JSON Schema validation for agent outputs
structured_outputs:
  # Master toggle for structured output validation
  enabled: true
  # Validation mode: strict (block on invalid), warn (warn only), disabled
  validation_mode: "warn"
  # Schema directory path (relative to .claude/)
  schema_dir: "schemas"
  # Schema mappings (file patterns -> schema names)
  schemas:
    prd: "prd.schema.json"
    sdd: "sdd.schema.json"
    sprint: "sprint.schema.json"
    trajectory: "trajectory-entry.schema.json"
  # Auto-validate outputs before writing
  auto_validate: true

# =============================================================================
# Extended Thinking (Claude Platform Integration)
# =============================================================================
# Extended thinking for complex reasoning agents
extended_thinking:
  # Master toggle for extended thinking features
  enabled: true
  # Budget tokens for thinking (0 = model decides, max 32000)
  budget_tokens: 16000
  # Agents that use extended thinking by default
  enabled_agents:
    - designing-architecture
    - reviewing-code
    - auditing-security
    - planning-sprints
  # Log thinking traces to trajectory
  log_thinking: true
  # Include thinking summary in output
  include_summary: true
  # Thinking step types to capture
  step_types:
    - analysis
    - hypothesis
    - evaluation
    - decision
    - reflection

# =============================================================================
# Trajectory Logging (Claude Platform Integration)
# =============================================================================
# ADK-style trajectory evaluation with extended thinking support
trajectory:
  # Enable trajectory logging
  enabled: true
  # Output directory for trajectory files
  output_dir: "grimoires/loa/a2a/trajectory"
  # File naming pattern: {agent}-{date}.jsonl
  file_pattern: "{agent}-{date}.jsonl"
  # Include extended thinking traces
  include_thinking: true
  # Grounding requirements
  grounding:
    # Require grounding for all claims
    required: true
    # Types of grounding to capture
    types:
      - citation
      - code_reference
      - assumption
      - user_input
      - inference
    # Minimum confidence for ungrounded claims
    min_confidence: 0.8
  # Retention settings
  retention:
    # Days to keep trajectory files (0 = forever)
    days: 30
    # Archive old files instead of deleting
    archive: true

# =============================================================================
# Tool Search (Claude Platform Integration)
# =============================================================================
# Dynamic tool discovery for MCP servers and Loa Constructs
tool_search:
  # Master toggle for tool search features
  enabled: true
  # Auto-discover available tools on startup
  auto_discover: true
  # Cache TTL in hours (0 = no caching)
  cache_ttl_hours: 24
  # Cache directory (default: ~/.loa/cache/tool-search)
  # cache_dir: ~/.loa/cache/tool-search
  # Include Loa Constructs in search results
  include_constructs: true
  # Default result limit for searches
  default_limit: 10
  # Search ranking weights (name match > description > scope)
  ranking:
    name_weight: 100
    description_weight: 50
    scope_weight: 30

# =============================================================================
# Context Management (Claude Platform Integration v0.11.0)
# =============================================================================
# Client-side compaction with Lossless Ledger Protocol
context_management:
  # Enable client-side compaction integration
  client_compaction: true
  # Always preserve NOTES.md critical sections
  preserve_notes_md: true
  # Use simplified 3-step checkpoint (vs full 7-step)
  simplified_checkpoint: true
  # Auto-log thinking blocks to trajectory before compaction
  auto_trajectory_log: true
  # Preservation rules (what survives compaction)
  preservation_rules:
    # Items that ALWAYS survive compaction
    always_preserve:
      - notes_session_continuity
      - notes_decision_log
      - trajectory_entries
      - active_beads
    # Items that CAN be compacted after use
    compactable:
      - tool_results
      - thinking_blocks
      - verbose_debug
      - redundant_file_reads
      - intermediate_outputs

  # -------------------------------------------------------------------------
  # Probe-Before-Load (RLM Pattern) - v0.14.0
  # -------------------------------------------------------------------------
  # Enable probe-before-load pattern (check file metadata before full read)
  probe_before_load: true
  # Files under this line count are loaded immediately without probe
  max_eager_load_lines: 500
  # Require relevance check for files exceeding threshold
  require_relevance_check: true
  # Keywords that increase relevance score (used for large file decisions)
  relevance_keywords:
    - export
    - class
    - interface
    - function
    - async
    - api
    - route
    - handler
  # Patterns to exclude from probing (always skipped)
  exclude_patterns:
    - "*.test.ts"
    - "*.spec.ts"
    - "node_modules/**"
    - "dist/**"
    - "build/**"
    - ".git/**"
  # Token budgets for loading strategy decisions
  token_budget:
    # Codebases under this are "small" - load all files
    small_codebase: 30000
    # Codebases under this are "medium" - prioritized loading
    medium_codebase: 150000
    # Codebases over medium are "large" - probe + excerpts only
    large_codebase: 500000

# =============================================================================
# Update Check (v0.14.0)
# =============================================================================
# Automatic version checking on session start
update_check:
  # Master toggle - set to false to disable all update checks
  enabled: true
  # Cache TTL in hours (0 = check every time)
  cache_ttl_hours: 24
  # Notification style: banner | line | silent
  notification_style: banner
  # Include pre-release versions in update checks
  include_prereleases: false
  # Custom upstream repo (for forks)
  upstream_repo: "0xHoneyJar/loa"

# =============================================================================
# Continuous Learning (v0.17.0)
# =============================================================================
# Autonomous skill extraction from debugging discoveries
continuous_learning:
  # Master toggle - set to false to disable all continuous learning
  enabled: true
  # Auto-extract skills during implementation phases (false = /retrospective only)
  auto_extract: true
  # Require manual approval before skills become active
  require_approval: true
  # Directories for skill lifecycle management (all in State Zone)
  skills_dir: grimoires/loa/skills
  pending_dir: grimoires/loa/skills-pending
  archive_dir: grimoires/loa/skills-archived
  # Quality gate thresholds
  quality_gates:
    # Minimum discovery depth: 1=any, 2=moderate, 3=significant
    min_discovery_depth: 2
    # Require solution verification before extraction
    require_verification: true
  # NOTES.md integration
  notes_integration:
    # Check NOTES.md for duplicate knowledge before extraction
    check_notes_md: true
    # Deduplicate against existing skills
    deduplicate: true
  # Pruning settings for /skill-audit --prune
  pruning:
    # Archive skills with no matches after N days
    prune_after_days: 90
    # Minimum match count to retain skill
    prune_min_matches: 2
    # Require confirmation before pruning
    auto_prune: false

# =============================================================================
# Compound Learning (v1.10.0) - Cross-Session Pattern Detection
# =============================================================================
# Batch retrospectives, pattern synthesis, and feedback loop for longitudinal learning
# PRD: grimoires/loa/prd.md | SDD: grimoires/loa/sdd.md
compound_learning:
  # Master toggle - set to false to disable all compound learning
  enabled: true

  # -------------------------------------------------------------------------
  # Similarity Strategy (Layered: Semantic → Keyword fallback)
  # -------------------------------------------------------------------------
  # Uses best available tool with graceful degradation
  similarity:
    # Prefer semantic tools (ck, Memory Stack) when available
    prefer_semantic: true

    # ck integration for code patterns
    ck:
      enabled: auto  # auto | true | false
      threshold: 0.7

    # Memory Stack integration for text embeddings
    memory_stack:
      enabled: auto  # auto | true | false
      model: all-MiniLM-L6-v2
      threshold: 0.35

    # qmd integration for grimoire search
    qmd:
      enabled: auto  # auto | true | false
      search_mode: hybrid  # hybrid | semantic | keyword

    # Fallback settings (when semantic tools unavailable)
    fallback:
      jaccard_threshold: 0.6
      min_keyword_overlap: 3

  # -------------------------------------------------------------------------
  # Pattern Detection Configuration
  # -------------------------------------------------------------------------
  pattern_detection:
    # Minimum occurrences to consider a pattern
    min_occurrences: 2
    # Maximum age for patterns in days (older patterns ignored)
    max_age_days: 90
    # Agents to exclude from pattern analysis
    exclude_agents: []
    # Pattern types to detect
    enabled_types:
      - repeated_error
      - convergent_solution
      - anti_pattern
      - project_convention

  # -------------------------------------------------------------------------
  # Quality Gates (4-Gate Filter)
  # -------------------------------------------------------------------------
  # Patterns must pass these gates to become skills
  quality_gates:
    # Discovery Depth: Is solution non-trivial?
    discovery_depth:
      min_score: 5
      weight: 1.0
    # Reusability: Is pattern generalizable?
    reusability:
      min_score: 5
      weight: 1.0
    # Trigger Clarity: Can we identify when this applies?
    trigger_clarity:
      min_score: 5
      weight: 1.0
    # Verification: Was solution verified to work?
    verification:
      min_score: 3  # Lower bar for verification
      weight: 0.8

  # -------------------------------------------------------------------------
  # Effectiveness Feedback Loop (Goal G-4)
  # -------------------------------------------------------------------------
  effectiveness:
    # Feedback signal weights
    signal_weights:
      task_completed: 3
      no_errors: 2
      no_revert: 2
      faster_completion: 1
      user_positive: 3
      user_negative: -5
    # Effectiveness tier thresholds
    tiers:
      high: 80      # Score >= 80: increase retrieval priority
      medium: 50    # Score >= 50: normal
      low: 20       # Score >= 20: flag for review
      # Score < 20: ineffective, queue for pruning
    # Pruning settings
    pruning:
      # Archive after N ineffective applications
      failures_before_prune: 3
      # Require human review before archiving
      require_review: true

  # -------------------------------------------------------------------------
  # Learning Synthesis (Goal G-3)
  # -------------------------------------------------------------------------
  synthesis:
    # Minimum cluster size for synthesis
    min_cluster_size: 3
    # Similarity threshold for skill clustering (lower than event matching)
    cluster_similarity_threshold: 0.4
    # Auto-archive source skills after merge
    archive_on_synthesis: false
    # Require human approval for all proposals
    require_approval: true

  # -------------------------------------------------------------------------
  # Morning Context Loading (Goal G-2)
  # -------------------------------------------------------------------------
  morning_context:
    # Enable morning context loading
    enabled: true
    # Maximum learnings to load at session start
    max_learnings: 5
    # Maximum age of learnings to consider (days)
    max_age_days: 30
    # Minimum effectiveness score to include
    min_effectiveness: 50
    # Don't show same learning if dismissed N times
    max_dismissals: 3
    # Performance target (must complete within)
    timeout_ms: 5000

  # -------------------------------------------------------------------------
  # Mermaid Visualization (PRD FR-10)
  # -------------------------------------------------------------------------
  # NOTE: Preview URLs use visual_communication protocol (see above section)
  # This section configures compound-learning-specific diagram settings
  visualization:
    # Enable Mermaid diagram generation
    enabled: true
    # Output format
    format: mermaid  # mermaid | ascii | both
    # Output directory for diagrams
    output_dir: grimoires/loa/diagrams/
    # Include diagrams in compound reports
    include_in_reports: true
    # Generate Beautiful Mermaid preview URLs (uses visual_communication.service)
    include_preview_urls: true
    # Color scheme for effectiveness levels
    color_scheme:
      high_effectiveness: "#10b981"   # green
      medium_effectiveness: "#fbbf24" # amber
      low_effectiveness: "#f4f4f5"    # gray
      current_focus: "#3b82f6"        # blue

  # -------------------------------------------------------------------------
  # Archive Management (PRD FR-9)
  # -------------------------------------------------------------------------
  archive:
    # Number of cycles to retain archives
    retention_cycles: 5
    # Compress archived files
    compress: false
    # Archive directory
    dir: grimoires/loa/archive/

# =============================================================================
# Run Mode (v0.18.0)
# =============================================================================
# Autonomous implementation with human-in-the-loop at PR review
run_mode:
  # Master toggle - set to false to disable Run Mode
  # IMPORTANT: Run Mode requires explicit opt-in for safety
  enabled: true
  # Default options for /run command
  defaults:
    # Maximum cycles before circuit breaker trips
    max_cycles: 20
    # Maximum runtime in hours before timeout
    timeout_hours: 8
  # Rate limiting to prevent API exhaustion
  rate_limiting:
    # Maximum API calls per hour during Run Mode
    calls_per_hour: 100
  # Circuit breaker thresholds
  circuit_breaker:
    # Halt after same finding appears N times
    same_issue_threshold: 3
    # Halt after N cycles with no file changes
    no_progress_threshold: 5
  # Git safety settings
  git:
    # Prefix for auto-created feature branches
    branch_prefix: "feature/"
    # Always create draft PRs (never ready for review)
    create_draft_pr: true
  # Sprint plan settings
  sprint_plan:
    # Default branch name for multi-sprint execution
    default_branch_name: "release"
    # Compound learning hook on sprint-plan completion (Task 8.8-8.9)
    compound_on_complete: true     # Trigger compound review after all sprints
    compound_auto_approve: false   # Auto-approve extracted skills
    compound_fail_action: warn     # warn | fail - what to do if compound fails

# =============================================================================
# Recursive JIT Context System (v0.20.0)
# =============================================================================
# Semantic result caching and condensation for recursive subagent patterns
recursive_jit:
  # -------------------------------------------------------------------------
  # Semantic Result Cache
  # -------------------------------------------------------------------------
  cache:
    # Master toggle for semantic cache
    enabled: true
    # Maximum cache size in MB (LRU eviction when exceeded)
    max_size_mb: 100
    # Time-to-live in days (entries expire after this period)
    ttl_days: 30

  # -------------------------------------------------------------------------
  # Condensation Engine
  # -------------------------------------------------------------------------
  condensation:
    # Default strategy for result condensation
    # Options: structured_verdict, identifiers_only, summary
    default_strategy: structured_verdict
    # Maximum tokens for condensed results
    max_condensed_tokens: 50
    # Preserve these fields in structured_verdict strategy
    preserve_fields:
      - verdict
      - severity_counts
      - top_findings

  # -------------------------------------------------------------------------
  # Semantic Recovery Enhancement
  # -------------------------------------------------------------------------
  recovery:
    # Enable semantic (query-based) recovery
    semantic_enabled: true
    # Fall back to positional recovery if semantic search fails
    fallback_to_positional: true
    # Prefer ck for semantic search when available
    prefer_ck: true

  # -------------------------------------------------------------------------
  # Early-Exit Coordination
  # -------------------------------------------------------------------------
  early_exit:
    # Enable early-exit protocol for parallel subagents
    enabled: true
    # Grace period in seconds before cleanup
    grace_period_seconds: 5

  # -------------------------------------------------------------------------
  # Continuous Synthesis (Anti-Platform-Summarization)
  # -------------------------------------------------------------------------
  # Automatically externalize data to ledgers when RLM operations occur.
  # This ensures critical information survives Claude Code's automatic
  # context summarization by writing to NOTES.md/trajectory at every
  # natural checkpoint (cache writes, condensation, early-exit signals).
  continuous_synthesis:
    # Master toggle for auto-synthesis
    enabled: true
    # Write to NOTES.md Decision Log on cache set operations
    on_cache_set: true
    # Log condensation decisions to trajectory
    on_condense: true
    # Log milestone completions on early-exit signals
    on_early_exit: true
    # Target for synthesis writes
    target: notes_decision_log
    # Also update active bead (if beads_rust available)
    update_bead: true

# =============================================================================
# GPT 5.2 Cross-Model Review (v0.20.0)
# =============================================================================
# GPT review for catching issues Claude might miss
gpt_review:
  # Master toggle - set to false to disable all GPT reviews
  # Note: Requires OPENAI_API_KEY environment variable (or in .env file)
  enabled: true
  # API timeout in seconds
  timeout_seconds: 300
  # Maximum review iterations before auto-approve
  max_iterations: 3
  # Model selection
  models:
    # Model for document reviews (PRD, SDD, Sprint)
    documents: "gpt-5.2"
    # Model for code reviews (uses Responses API)
    code: "gpt-5.2-codex"
  # Per-phase toggles (only used when enabled: true)
  phases:
    prd: true
    sdd: true
    sprint: true
    implementation: true

# =============================================================================
# Plan and Analyze Configuration (v1.6.0)
# =============================================================================
# Codebase grounding integration with /ride for brownfield projects
plan_and_analyze:
  codebase_grounding:
    # Master toggle - set to false to disable codebase grounding entirely
    enabled: true
    # Days before reality files are considered stale (prompt user to re-run)
    reality_staleness_days: 7
    # Timeout in minutes for /ride execution
    ride_timeout_minutes: 20
    # Auto-skip to Phase -1 if /ride fails (not recommended)
    skip_on_ride_error: false

# =============================================================================
# Claude Code 2.1.x Features (v1.9.0)
# =============================================================================
# Alignment with Claude Code 2.1.x platform capabilities

# Setup Hook - triggered on `claude --init`
setup_hook:
  # Run upgrade-health-check.sh on initialization
  enabled: true
  # Run full health check (vs quick check)
  run_health_check: true

# Skill Forking - isolated execution for read-only skills
skill_forking:
  # Master toggle for skill forking features
  enabled: true
  # Fork read-only skills (ride, validators) by default
  fork_read_only_skills: true

# One-Time Hooks - prevent duplicate hook execution
hooks:
  # Run update check only once per session (not on resume)
  check_updates_once: true

# Trajectory Session ID - cross-session correlation
trajectory_session_id:
  # Include CLAUDE_SESSION_ID in trajectory entries
  enabled: true

# File Read Limits (Claude Code environment variable)
# Set CLAUDE_CODE_FILE_READ_MAX_OUTPUT_TOKENS to limit file read output
# Default: 4000 tokens
# Example: export CLAUDE_CODE_FILE_READ_MAX_OUTPUT_TOKENS=8000
file_read_limits:
  max_output_tokens: 4000

# =============================================================================
# Visual Communication (v1.10.0)
# =============================================================================
# Beautiful Mermaid integration for diagram rendering
visual_communication:
  # Master toggle for visual output
  enabled: true

  # Rendering service URL
  service: "https://agents.craft.do/mermaid"

  # Default theme (github | dracula | nord | tokyo-night | solarized-light | solarized-dark | catppuccin)
  theme: "github"

  # Include clickable preview URLs in output
  include_preview_urls: true

  # Diagram types to support
  diagram_types:
    flowchart: true
    sequence: true
    class: true
    state: true
    er: true

# =============================================================================
# Oracle Configuration (v1.11.0)
# =============================================================================
# Extended oracle with Loa compound learnings support (Issue #76)
oracle:
  # -------------------------------------------------------------------------
  # Source Weights (Hierarchical)
  # -------------------------------------------------------------------------
  # Results are ranked by weighted_score = match_score * source_weight
  weights:
    loa: 1.0         # Highest priority - Loa's own proven patterns
    anthropic: 0.8   # Authoritative - Anthropic official documentation
    community: 0.5   # Useful but less verified community contributions

  # -------------------------------------------------------------------------
  # Loa Source Configuration
  # -------------------------------------------------------------------------
  # Sources for Loa's compound learnings
  loa_sources:
    skills:
      enabled: true
      paths: [".claude/skills/**/*.md"]
    feedback:
      enabled: true
      paths: ["grimoires/loa/feedback/*.yaml"]
    decisions:
      enabled: true
      paths: ["grimoires/loa/decisions.yaml"]
    learnings:
      enabled: true
      paths: ["grimoires/loa/a2a/compound/learnings.json"]

  # -------------------------------------------------------------------------
  # Index Settings
  # -------------------------------------------------------------------------
  index:
    # Auto-refresh index after N hours (0 = manual only)
    auto_refresh_hours: 24
    # Cache directory for index files
    cache_dir: "~/.loa/cache/oracle"

  # -------------------------------------------------------------------------
  # Query Settings
  # -------------------------------------------------------------------------
  query:
    # Default indexer: auto (use QMD if available, fallback to grep)
    # Options: auto | qmd | grep
    default_indexer: auto
    # Default result limit
    default_limit: 10
    # Default scope when not specified: all | loa | anthropic
    default_scope: all

# =============================================================================
# Two-Tier Learnings Architecture (v1.15.1 - PR #139)
# =============================================================================
# Framework learnings ship with Loa, project learnings accumulate over time
# Based on Issue #137 (oracle exit code) and Issue #76 (Loa as oracle)
learnings:
  # -------------------------------------------------------------------------
  # Tier Configuration
  # -------------------------------------------------------------------------
  tiers:
    # Framework Tier (Tier 1) - Ships with Loa in .claude/loa/learnings/
    framework:
      # Enable framework learnings
      enabled: true
      # Weight for ranking (higher = more prominent in results)
      weight: 1.0
      # Source directory (relative to project root)
      source_dir: ".claude/loa/learnings"

    # Project Tier (Tier 2) - Accumulates in grimoires/loa/
    project:
      # Enable project learnings
      enabled: true
      # Weight for ranking (slightly lower to prefer framework patterns)
      weight: 0.9
      # Source paths (relative to project root)
      sources:
        - "grimoires/loa/a2a/compound/learnings.json"
        - "grimoires/loa/feedback/*.yaml"

  # -------------------------------------------------------------------------
  # Query Settings
  # -------------------------------------------------------------------------
  query:
    # Default tier filter: all | framework | project
    default_tier: all
    # Maximum results per query
    max_results: 10
    # Deduplicate by content hash across tiers
    deduplicate: true

  # -------------------------------------------------------------------------
  # Index Settings
  # -------------------------------------------------------------------------
  index:
    # Auto-rebuild index after /update-loa
    rebuild_on_update: true
    # Index cache directory
    cache_dir: "~/.loa/cache/oracle/loa"

# =============================================================================
# Upstream Learning Detection (v1.16.0 - Upstream Learning Flow)
# =============================================================================
# Silent detection of high-value learnings eligible for upstream contribution
# PRD: grimoires/loa/prd.md (Upstream Learning Flow v1.1.0)
upstream_detection:
  # Master toggle - set to false to disable upstream detection entirely
  enabled: true

  # Minimum occurrences (applications) before eligible for upstream
  # Lower values find candidates earlier, higher values require more proof
  min_occurrences: 3

  # Minimum success rate (0.0-1.0) for upstream eligibility
  # 0.8 = 80% of applications must be successful
  min_success_rate: 0.8

  # Minimum upstream score (0-100) for eligibility
  # Score is weighted: quality(25%) + effectiveness(30%) + novelty(25%) + generality(20%)
  min_upstream_score: 70

  # Novelty threshold (0.0-1.0) for duplicate detection via Jaccard similarity
  # Learnings with similarity >= threshold to existing proposals are blocked
  novelty_threshold: 0.7

  # Check learnings from last N days during post-retrospective hook
  check_days: 1

  # Silent mode - only show candidates, never auto-propose
  silent: true

# =============================================================================
# Upstream Proposals (v1.16.0 - Upstream Learning Flow)
# =============================================================================
# Configuration for submitting learning proposals to upstream Loa repository
upstream_proposals:
  # Target repository for upstream proposals
  target_repo: "0xHoneyJar/loa"

  # GitHub label for learning proposals
  label: "learning-proposal"

  # -------------------------------------------------------------------------
  # Anonymization Settings
  # -------------------------------------------------------------------------
  anonymization:
    # Enable PII anonymization before submission (strongly recommended)
    enabled: true
    # Validate that no PII remains after anonymization
    validate: true
    # Strict mode - fail if validation finds potential PII
    strict: false

  # -------------------------------------------------------------------------
  # Rejection Handling
  # -------------------------------------------------------------------------
  # Days to wait before resubmitting a rejected proposal
  rejection_cooldown_days: 90

  # Auto-check proposal status on session start
  auto_check_status: false

# =============================================================================
# Autonomous Agent Orchestration (v1.11.0)
# =============================================================================
# Meta-orchestrator for exhaustive Loa process compliance
# PRD: grimoires/loa/prd.md | SDD: grimoires/loa/sdd.md | PR: #82
autonomous_agent:
  # -------------------------------------------------------------------------
  # Operator Detection
  # -------------------------------------------------------------------------
  # Determines AI vs Human operator for behavior adjustment
  operator:
    # Detection mode: auto | human | ai
    type: auto

    # AI-specific configuration (when operator=ai detected)
    ai_config:
      # Auto-wrap skills with /autonomous
      enforce_autonomous_skill: true
      # All quality gates mandatory
      strict_quality_gates: true
      # Must pass audit before PR creation
      require_audit_before_pr: true
      # Must pass audit before deploy
      require_audit_before_deploy: true

  # -------------------------------------------------------------------------
  # Quality Thresholds
  # -------------------------------------------------------------------------
  # Minimum audit score (1-5) to pass Gate 4
  audit_threshold: 4
  # Maximum remediation loops before escalation
  max_remediation_loops: 3

  # -------------------------------------------------------------------------
  # Deployment Settings
  # -------------------------------------------------------------------------
  # Require human approval for deployment
  require_human_deploy_approval: true

  # -------------------------------------------------------------------------
  # Attention Budget (Tokens)
  # -------------------------------------------------------------------------
  # Token thresholds for context management
  attention_budget:
    # Tokens per single search operation (TRC trigger)
    single_search: 2000
    # Accumulated tokens threshold for mandatory TRC
    accumulated: 5000
    # Session total before checkpoint & yield
    session_total: 15000

  # -------------------------------------------------------------------------
  # Context Management
  # -------------------------------------------------------------------------
  context:
    # Soft limit - trigger standard compaction
    soft_limit_tokens: 80000
    # Hard limit - trigger emergency compaction
    hard_limit_tokens: 150000
    # Write checkpoint after each phase
    checkpoint_after_each_phase: true

  # -------------------------------------------------------------------------
  # Feedback Capture (Issue #48)
  # -------------------------------------------------------------------------
  feedback:
    # Enable feedback collection
    enabled: true
    # Output directory
    output_dir: grimoires/loa/feedback
    # Auto-flush at phase end
    auto_flush: true
    # Minimum severity to capture
    min_severity: low
    # Types to collect
    collect_types:
      - gap
      - friction
      - pattern
      - improvement

  # -------------------------------------------------------------------------
  # PRD Iteration (Issue #29)
  # -------------------------------------------------------------------------
  prd_iteration:
    # Enable PRD iteration detection
    enabled: true
    # Output file for gaps
    gaps_file: grimoires/loa/gaps.yaml
    # Threshold for minor gaps to trigger review
    minor_gap_threshold: 3
    # Auto-recommend /refine-prd on major gaps
    auto_recommend_refine: true
    # Block autonomous execution on major gaps
    block_on_major_gaps: true

  # -------------------------------------------------------------------------
  # Structured Notes (Issue #23)
  # -------------------------------------------------------------------------
  structured_notes:
    # Enable structured note management
    enabled: true
    # Notes file location
    notes_file: grimoires/loa/NOTES.md
    # Expiry settings (days, null = never)
    expiry:
      synthesis: 7
      observation: 14
      decision: null
      blocker: null
      question: 14
    # Auto-cleanup expired notes
    auto_cleanup: false
    # Archive location for cleaned notes
    archive_dir: grimoires/loa/archive/notes/

# =============================================================================
# Feedback Routing (v1.11.0 - Issue #81)
# =============================================================================
# Smart routing of /feedback submissions to appropriate ecosystem repos
feedback:
  routing:
    # Master toggle - when false, feedback goes to default repo
    enabled: true
    # Automatically classify feedback based on context signals
    auto_classify: true
    # Always ask user to confirm before submitting
    require_confirmation: true
    # Create tracking issue in loa repo for non-loa feedback (future)
    cross_reference: false

  # Repository mapping
  repos:
    framework: "0xHoneyJar/loa"
    constructs: "0xHoneyJar/loa-constructs"
    forge: "0xHoneyJar/forge"
    project: "${GITHUB_REPOSITORY}"  # Current repo

  # Label configuration
  labels:
    # Don't fail if labels don't exist
    graceful_missing: true
    # Default labels to apply
    default:
      - "feedback"
      - "user-report"

  # -------------------------------------------------------------------------
  # Trace-Based Routing (v1.28.0 - Issue #171)
  # -------------------------------------------------------------------------
  # Analyze execution trajectory to automatically route feedback to the
  # appropriate skill or construct based on recent activity.
  trace_routing:
    # Master toggle - disabled by default for staged rollout
    enabled: false
    # Minimum confidence (0-100) to use trace-based routing
    confidence_threshold: 70
    # Hours of trajectory history to analyze
    time_window_hours: 24
    # Health check timeout in milliseconds
    health_check_timeout_ms: 100
    # Full analysis timeout in seconds
    analysis_timeout_seconds: 5

# =============================================================================
# Update-Loa Branch Testing (v1.11.0 - Issue #91)
# =============================================================================
# WIP branch checkout vs merge option for PR review workflows
update_loa:
  branch_testing:
    # Enable checkout option for feature branches
    enabled: true
    # Branch patterns that trigger checkout option
    feature_patterns:
      - "feature/*"
      - "fix/*"
      - "topic/*"
      - "wip/*"
      - "test/*"
    # Prefix for local test branches
    test_branch_prefix: "test/loa-"
    # State file location
    state_file: ".loa/branch-testing.json"

# =============================================================================
# Effort Parameter (v1.13.0 - Issue #94)
# =============================================================================
# Control reasoning depth vs token efficiency for extended thinking
# Based on Anthropic's effort parameter: https://www.anthropic.com/news/claude-opus-4-6
#
# IMPORTANT: The actual API uses `thinking.budget_tokens` (integer), not named effort levels.
# These conceptual levels map to budget_tokens ranges that runtimes should use.
# Loa defines the WHAT (conceptual levels, skill hints); runtime executes the HOW (API calls).
#
# Performance claims (Anthropic benchmarks):
# - Medium effort: 76% fewer output tokens with equivalent quality on SWE-bench
# - High effort: 48% fewer tokens while exceeding Sonnet 4.5 by 4.3 percentage points
effort:
  # Default effort level for all skills
  # Options: low | medium | high
  # - low: Minimal reasoning, fastest response (~1,024-4,000 budget_tokens)
  # - medium: Balanced quality/cost (~8,000-16,000 budget_tokens) [RECOMMENDED]
  # - high: Maximum reasoning depth (~24,000-32,000 budget_tokens)
  default_level: medium

  # Budget token ranges for each effort level (runtime uses these)
  # NOTE: Gaps between ranges (4K-8K, 16K-24K) are intentional separation zones.
  # Skills wanting intermediate budgets should use the higher level.
  # Example: 6K tokens → use "medium" (min 8K)
  budget_ranges:
    low:
      min: 1024
      max: 4000
    medium:
      min: 8000
      max: 16000
    high:
      min: 24000
      max: 32000

  # Per-skill effort overrides
  # Skills can declare their recommended effort in SKILL.md frontmatter
  per_skill:
    # Security audits need deep reasoning for vulnerability analysis
    auditing-security: high
    # Architecture decisions benefit from thorough analysis
    designing-architecture: high
    # Code review should be thorough but not exhaustive
    reviewing-code: medium
    # Implementation is balanced
    implementing-tasks: medium
    # Sprint planning needs good analysis
    planning-sprints: medium
    # PRD discovery benefits from depth
    discovering-requirements: medium
    # Executive translation is simpler summarization
    translating-for-executives: low

  # AI operator adjustment (when autonomous_agent.operator.type = ai)
  # AI operators may use lower effort by default to conserve tokens
  ai_operator_adjustment:
    enabled: true
    # Reduce effort level by this amount for AI operators
    # 0 = no reduction, 1 = reduce by one level, 2 = always use low
    reduction: 0

# =============================================================================
# Context Editing Protocol (v1.13.0 - Issue #95)
# =============================================================================
# Auto-compaction protocol for long-running agentic workflows
# Based on Anthropic's context editing: https://claude.com/blog/context-management
#
# IMPORTANT: Actual context editing is a runtime/API feature (beta header: context-management-2025-06-27).
# Loa defines WHAT to compact and WHEN (thresholds, priorities).
# Runtime layer executes HOW (actual token counting, API calls).
#
# Performance claims (Anthropic benchmarks):
# - 84% token reduction in 100-turn web search evaluation
# - 29% improvement from context editing alone
# - Enables workflows that would otherwise fail due to context exhaustion
context_editing:
  # Master toggle for context editing protocol
  enabled: true

  # Trigger compaction when context reaches this % of limit
  # Runtime should signal CONTEXT_NEAR_LIMIT when this threshold is reached
  compact_threshold_percent: 80

  # Minimum turns to preserve (recent context stays intact)
  preserve_recent_turns: 5

  # What to clear (priority order, lowest priority cleared first)
  clear_targets:
    - stale_tool_results        # Old tool call results
    - completed_phase_details   # Details from finished phases
    - superseded_file_reads     # Files that were re-read with newer content
    - intermediate_outputs      # Temporary/intermediate results
    - verbose_debug             # Debug logs and verbose output

  # Phase-based clearing triggers
  # Clear after these phases complete (for autonomous agent)
  clear_after_phases:
    - initialization    # Phase 1: After init complete
    - implementation    # Phase 5: After code written
    - testing           # Phase 6: After tests pass

  # Artifacts to always preserve (never clear)
  preserve_artifacts:
    - trajectory_events         # Audit trail
    - quality_gate_results      # Gate decisions
    - decision_records          # Architecture decisions
    - notes_session_continuity  # Recovery anchor
    - active_beads              # Current task state

  # Runtime integration signals
  # These are hints for runtime implementations
  runtime_signals:
    # Signal name when context approaches limit
    context_near_limit: "CONTEXT_NEAR_LIMIT"
    # Signal name when compaction is complete
    compaction_complete: "COMPACTION_COMPLETE"
    # Token threshold percentage that triggers the signal
    signal_threshold_percent: 80

# =============================================================================
# Skills Configuration (v1.14.0 - Issue #97)
# =============================================================================
# Skill loading and categorization settings.
# Based on Vercel AI SDK and Anthropic tool-writing best practices.
#
# NOTE: defer_loading is configuration preparation only.
# Actual deferred loading requires runtime implementation (Phase 2).
skills:
  # Master toggle for deferred loading (disabled by default)
  # When true, skills with defer_loading: true are loaded on-demand
  defer_loading: false

  # Skills that are NEVER deferred (always loaded)
  always_load:
    - autonomous-agent
    - run-mode

  # Semantic categories for skill search
  # Used by future skill search implementation
  categories:
    planning:
      - discovering-requirements
      - planning-sprints
      - designing-architecture
    implementation:
      - implementing-tasks
      - deploying-infrastructure
    quality:
      - reviewing-code
      - auditing-security
    support:
      - translating-for-executives
      - continuous-learning
    operations:
      - autonomous-agent
      - run-mode
      - riding-codebase
      - mounting-framework

# =============================================================================
# Memory Schema (v1.13.0 - Issue #96)
# =============================================================================
# Formalized memory persistence with lifecycle management
# Based on Anthropic's memory tool concept: https://claude.com/blog/context-management
#
# IMPORTANT: This is Loa's grimoire-based memory system, NOT Anthropic's memory tool API.
# Anthropic's memory tool operates via tool calls to a memory directory.
# Loa's system uses grimoire files (decisions.yaml, learnings.json, NOTES.md).
# Both achieve similar goals: persistent cross-session knowledge.
#
# Performance claims (Anthropic benchmarks):
# - 39% performance improvement combining memory with context editing
# - Enables building knowledge bases that persist across conversations
memory_schema:
  # Master toggle for formalized memory schema
  enabled: true

  # Storage directory for memory files
  storage_dir: grimoires/loa/memory

  # Memory categories with their characteristics
  categories:
    # Stable facts about the project (rarely change)
    fact:
      ttl: permanent
      confidence_required: 0.8
      storage_file: facts.yaml
    # Architecture/implementation decisions (supersedable)
    decision:
      ttl: permanent
      confidence_required: 0.9
      storage_file: decisions.yaml  # Already exists, formalize it
    # Extracted patterns from experience
    learning:
      ttl: 90d  # Learnings can become stale
      confidence_required: 0.7
      storage_file: learnings.yaml
    # Error-solution pairs for debugging
    error:
      ttl: 30d  # Errors are context-specific
      confidence_required: 0.6
      storage_file: errors.yaml
    # User/project preferences
    preference:
      ttl: permanent
      confidence_required: 0.5
      storage_file: preferences.yaml

  # Auto-capture from existing systems
  auto_capture:
    # Capture from decision protocol (PR #86)
    decisions: true
    # Capture error-solution pairs during implementation
    errors: true
    # Capture from compound learning (PR #67)
    learnings: true

  # Retrieval settings
  retrieval:
    # Maximum memories to return per query
    max_per_query: 10
    # Minimum confidence score for retrieval
    min_confidence: 0.6
    # Prefer recent memories (recency weighting)
    recency_weight: 0.2
    # Integration with oracle queries
    integrate_with_oracle: true

  # Lifecycle management
  lifecycle:
    # Auto-archive expired memories
    auto_archive: true
    # Archive directory
    archive_dir: grimoires/loa/memory/archive
    # Check for expiry on session start
    check_on_session_start: true
    # Warn before archiving (days before TTL)
    warn_before_archive_days: 7

# =============================================================================
# Prompt Enhancement (v1.14.0 - Issue #108, #109)
# =============================================================================
# Intelligent prompt enhancement using PTCF framework (Persona + Task + Context + Format)
# Based on Google Gemini prompting guide and self-distillation methods
prompt_enhancement:
  # Master toggle - set to false to disable prompt enhancement
  enabled: true

  # Quality score threshold for auto-enhancement (0-10)
  # Prompts scoring below this are automatically enhanced
  auto_enhance_threshold: 4

  # Show quality analysis in output (before/after scores, components)
  show_analysis: true

  # Maximum refinement iterations (feedback loop)
  max_refinement_iterations: 3

  # Path to custom templates (overrides defaults)
  # custom_templates_path: ".claude/overrides/templates/prompts/"

  # Task types to enable (empty array = all enabled)
  enabled_task_types: []

  # Middleware mode: enhance before other skills
  middleware:
    # Enable middleware mode (enhance prompts before skill execution)
    enabled: false
    # Skills to exclude from middleware enhancement
    exclude_skills:
      - "enhancing-prompts"  # Prevent recursion
      - "run-mode"           # Don't enhance autonomous mode

# =============================================================================
# Flatline Protocol (v1.17.0 - Issue #29)
# =============================================================================
# Multi-model adversarial review for planning documents
# Uses Claude Opus 4.6 + GPT-5.2 for cross-validation with consensus extraction
flatline_protocol:
  # Master toggle - set to false to disable Flatline Protocol
  enabled: true

  # Auto-trigger after planning commands (plan-and-analyze, architect, sprint-plan)
  auto_trigger: true

  # Models for adversarial review
  models:
    # Primary model (default: Claude Opus 4.6)
    primary: "opus"
    # Secondary model (default: GPT-5.2)
    secondary: "gpt-5.2"
    # Tertiary model (future, optional)
    # tertiary: "gemini-2.0"

  # Consensus thresholds (0-1000 scale)
  thresholds:
    # Both models >700 = auto-integrate improvement
    high_consensus: 700
    # Score difference >300 = disputed, present to user
    dispute_delta: 300
    # Both models <400 = discard as low value
    low_value: 400
    # Skeptic concern >700 = blocker, must address
    blocker: 700

  # Phase-specific toggles
  phases:
    prd: true
    sdd: true
    sprint: true

  # Budget controls
  budget:
    # Maximum tokens per review phase
    max_tokens_per_phase: 100000
    # Warn when budget reaches this percentage
    warn_at_percent: 80
    # Hard budget limit in cents (default: 300 = $3.00)
    hard_limit_cents: 300
    # Block if budget exceeded (vs warn and continue)
    block_on_exceed: false

  # Knowledge retrieval (Two-Tier Hub)
  knowledge:
    # Local grimoire search (Tier 1 - P0)
    local:
      enabled: true
      sources:
        - ".claude/loa/learnings/"
        - "grimoires/loa/context/"
        - "grimoires/loa/a2a/compound/"
    # NotebookLM integration (Tier 2 - P1)
    # Requires Python 3.10+, Patchright, and one-time Google authentication
    # Setup: python3 .claude/skills/flatline-knowledge/resources/notebooklm-query.py --setup-auth
    notebooklm:
      enabled: false
      # NotebookLM notebook ID to query (from URL)
      notebook_id: ""
      # Query timeout in milliseconds
      timeout_ms: 30000
      # Run browser in headless mode (set false for debugging)
      headless: true
      # Custom auth directory (optional, default: ~/.claude/notebooklm-auth/)
      # auth_dir: ""

# =============================================================================
# Behavior Preferences
# =============================================================================
preferences:
  auto_bead_on_review: true
  require_security_audit: true
  confirm_app_writes: true

# =============================================================================
# Simstim HITL Workflow (v1.24.0)
# =============================================================================
# Human-in-the-loop accelerated development with Flatline integration
simstim:
  enabled: true
  flatline:
    auto_accept_high_consensus: true
    show_disputed: true
    show_blockers: true
    phases:
      - prd
      - sdd
      - sprint
  defaults:
    timeout_hours: 24

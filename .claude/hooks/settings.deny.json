{
  "_comment": "Recommended deny rules for Loa-mounted projects. Blocks agent access to credential stores and sensitive configuration. Merge into ~/.claude/settings.json via install-deny-rules.sh or /mount.",
  "_source": "Trail of Bits claude-code-config, adapted for Loa (cycle-011, issue #297)",
  "_why": {
    "ssh_aws_kube_gnupg": "WHY Read+Edit blocked: These directories contain private keys and authentication tokens. Any read access could exfiltrate credentials; any edit could inject backdoors. There is no legitimate reason for an AI agent to access SSH keys or cloud credentials.",
    "npmrc_pypirc_git_credentials": "WHY Read+Edit blocked: Package registry and git credentials enable supply chain attacks. A compromised token could publish malicious packages or push to arbitrary repositories.",
    "gh_config": "WHY Read+Edit blocked: GitHub CLI tokens (~/.config/gh/) grant API access to all repos the user can reach. Read-blocking prevents token exfiltration; edit-blocking prevents token substitution.",
    "shell_configs_edit_only": "WHY Edit blocked but Read allowed for ~/.bashrc, ~/.zshrc, ~/.profile: Some tools need to read shell config for environment detection (e.g., detecting PATH, nvm, pyenv). But editing shell config could persist malicious changes (aliases, PATH manipulation) that survive across sessions â€” a persistence mechanism. Read is safe; write is the threat vector.",
    "glob_patterns": "WHY ** glob patterns: Claude Code deny rules use glob matching. The ** pattern ensures subdirectories are covered (e.g., ~/.ssh/config, ~/.aws/credentials, ~/.kube/contexts/). Without **, only direct children would be blocked."
  },
  "permissions": {
    "deny": [
      "Read(~/.ssh/**)",
      "Edit(~/.ssh/**)",
      "Read(~/.aws/**)",
      "Edit(~/.aws/**)",
      "Read(~/.kube/**)",
      "Edit(~/.kube/**)",
      "Read(~/.gnupg/**)",
      "Edit(~/.gnupg/**)",
      "Read(~/.npmrc)",
      "Edit(~/.npmrc)",
      "Read(~/.pypirc)",
      "Edit(~/.pypirc)",
      "Read(~/.git-credentials)",
      "Edit(~/.git-credentials)",
      "Read(~/.config/gh/**)",
      "Edit(~/.config/gh/**)",
      "Edit(~/.bashrc)",
      "Edit(~/.zshrc)",
      "Edit(~/.profile)"
    ]
  }
}

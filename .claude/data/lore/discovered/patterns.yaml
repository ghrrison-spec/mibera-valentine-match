# Discovered Patterns — Seeded from PR #324 Bridge Reviews
# These entries were extracted from Bridgebuilder analysis and represent
# validated architectural patterns discovered through the bridge loop.
# Future entries are auto-generated by lore-discover.sh.
#
# Fields: id, term, short, context, source, source_model, tags, loa_mapping
# source_model: which model produced the insight ("claude-opus-4" | "unknown")

entries:
  - id: graceful-degradation-cascade
    term: "Graceful Degradation Cascade"
    short: "Multi-step fallback pipeline where each step handles a subset of inputs — Netflix's Zuul routing pattern applied to data normalization"
    context: |
      The normalize_json_response() function in normalize-json.sh implements
      a 5-step extraction cascade: raw jq → markdown fence → raw parse →
      python3 → sed fallback. Each step handles progressively more malformed
      inputs. This mirrors Netflix's Zuul gateway pattern where requests
      pass through a chain of filters, each handling specific failure modes.
      The key insight: order matters. The most common (and cheapest) extraction
      runs first, with expensive fallbacks reserved for edge cases.
    source: "Bridge review bridge-20260214-e8fa94 / PR #324, BB-001"
    source_model: "claude-opus-4"
    tags: [discovered, architecture]
    loa_mapping: ".claude/scripts/lib/normalize-json.sh — 5-step cascade"

  - id: prompt-privilege-ring
    term: "Prompt Privilege Ring"
    short: "Hierarchical authority model within prompts — persona at Ring 0, context wrapped in de-authorization markers"
    context: |
      The Bridgebuilder review system uses a privilege ring model borrowed
      from OS kernel architecture. The persona file operates at Ring 0
      (highest privilege) — it defines identity, voice, and review methodology.
      External content (PR diffs, findings from previous iterations) is
      wrapped in de-authorization markers that prevent it from overriding
      persona instructions. This is a defense against prompt injection where
      attacker-controlled content in PR descriptions could attempt to alter
      the reviewer's behavior. Intel's Ring 0-3 architecture, now applied
      to prompt engineering.
    source: "Bridge review bridge-20260214-e8fa94 / PR #324, BB-002"
    source_model: "claude-opus-4"
    tags: [discovered, security, architecture]
    loa_mapping: "Bridgebuilder persona injection in bridge-orchestrator.sh"

  - id: convergence-engine
    term: "Convergence Engine"
    short: "Iterative improvement loop with severity-weighted scoring and kaironic termination — gradient descent for code quality"
    context: |
      The bridge loop implements a convergence engine pattern: each iteration
      runs implementation → review → scoring, tracking a severity-weighted
      score. The score functions as a loss metric — when it drops below
      threshold for consecutive iterations (flatline), the system has
      converged and terminates. This mirrors gradient descent in ML training
      where you iterate until the loss plateaus. The "kaironic" termination
      (from kairos, the right moment) means the loop ends when insight is
      exhausted, not when a timer expires.
    source: "Bridge review bridge-20260214-e8fa94 / PR #324, bridge loop analysis"
    source_model: "claude-opus-4"
    tags: [discovered, architecture, philosophy]
    loa_mapping: "bridge-orchestrator.sh — flatline detection and severity scoring"

  - id: governance-isomorphism
    term: "Governance Isomorphism"
    short: "Access to scarce resources governed through multi-perspective evaluation with fail-closed semantics"
    context: |
      The review pipeline and the vault share an identical governance shape:
      multiple independent evaluators must reach consensus before state changes
      are permitted, with the default being rejection. The Condorcet jury theorem
      provides the mathematical foundation — majority voting accuracy approaches 1
      as group size grows. Google's Tricorder cascading demonstrates the same
      principle at scale. Elinor Ostrom's commons governance principles explain
      why this pattern works across domains.
    source: "PR #429, deep review Part 4 / cycle-046"
    source_model: "claude-opus-4"
    tags: [discovered, governance, consensus, cross-ecosystem]
    loa_mapping: "Flatline consensus, Red Team attack/defense, vault multisig"
    lifecycle:
      references: 2
      last_seen: "2026-02-28"
      seen_in: ["bridge-20260228-cycle046"]
      repos: ["loa"]
      significance: recurring

  - id: deliberative-council
    term: "Deliberative Council"
    short: "Later review stages condition on earlier findings, transforming sequential evaluation into structured deliberation"
    context: |
      When review stage N receives findings from stage N-1, it shifts from
      independent evaluation to informed deliberation. The Condorcet jury theorem
      applies: independent evaluators with better-than-random accuracy produce
      majority decisions approaching certainty. Google's Tricorder system
      implements this at scale with composable analysis passes. Web4 insight:
      findings must be scarce but perspectives can be infinite.
    source: "PR #433, deep review Part 1 / cycle-047"
    source_model: "claude-opus-4"
    tags: [discovered, architecture, review, deliberation]
    loa_mapping: "Red Team → Bridgebuilder review pipeline in bridge-orchestrator.sh"
    lifecycle:
      references: 1
      last_seen: "2026-02-28"
      seen_in: ["bridge-20260228-cycle047"]
      repos: ["loa"]
      significance: one-off
